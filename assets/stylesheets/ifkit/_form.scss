//@ [Group] Forms
//

//@ [Variable] $if-textboxes
// Alias for the selector that targets all textboxes. Equivalent to
// `input[type=text], input[type=password],
// input[type=email], input[type=search], input:not([type])`.

@import 'ifkit/settings';
@import 'compass/css3';

//@ [Mixin] if-textbox
//
//     # CSS
//     #{$if-textboxes} {
//       &.textbox {
//         @include if-textbox; } }
//
//     # HAML
//     %input.textbox{type: 'text', value: 'Normal text box'}
//     and
//     %input.textbox{type: 'text', value: 'Disabled text box', disabled: true}
//
// Textbox. Includes styles for disabled, hover, focus, et al. Works great
// for `<input>` and `<textarea>` alike.
//
@mixin if-textbox(
  $height              : $if-input-height,
  $padding             : $if-input-padding,
  $radius              : $if-input-border-radius,
  $bg                  : $if-input-background,
  $border-opacity      : $if-input-border-opacity,
  $shadow              : $if-input-shadow,
  $disabled-strength   : 0.97,
  $text-color          : mix(#888, invert($bg), 40%),
  $disabled-text-color : mix(#888, $bg, 70%)
) {
  @include box-sizing(border-box);
  min-height: $height;

  padding: $padding;
  border: solid 1px rgba(black, $border-opacity);
  @include border-radius($radius);
  @include box-shadow($shadow);
  background: $bg;

  color: $text-color;
  font-size: $if-form-font-size;

  &:not(:disabled):hover {
    border-color: mix($if-accent, rgba(black, $border-opacity), 60%); }

  &:focus {
    @include transition(all 150ms linear);
    outline: 0;
    border-color: $if-accent;
    @include box-shadow(
      $if-input-shadow,
      0 0 8px rgba($if-accent, 0.5),
      0 0 4px rgba($if-accent, 0.5)); }

  &:disabled {
    cursor: not-allowed;
    background: $bg * $disabled-strength;
    text-shadow: 1px 1px 1px rgba(white, 0.4);
    color: $disabled-text-color; } }

//@[Mixin] if-select([ $height, $background-color ])
//
//     # HAML
//     %select.my-select
//       %option Choose your weapon...
//     and
//     %select.my-select{disabled: true}
//       %option Disabled
//
//     # CSS
//     .my-select {
//       @include if-select; }
//
@mixin if-select(
  $height : $if-input-height,
  $bg     : $if-input-background,
  $text-color : mix(#888, invert($bg), 40%)
) {
  $disabled-strength: 0.97;
  $disabled-text-color: mix(#888, $bg, 70%);

  height: $height;
  line-height: $height;

  background: $bg;
  color: #333;
  border: solid 1px mix($text-color, $bg, 20%);

  &:disabled {
    background: $bg * $disabled-strength;
    color: $disabled-text-color; } }

//@[Mixin] if-form-layout([ $label-width, $field-height, $field-margin, $field-selector, $control-group-selector, $control-selector ])
//
//     # HAML
//     %form.my-form
//       .field
//         %label Username:
//         %input{type: 'text'}
//       .field
//         %label Email:
//         .controls
//           %input{type: 'text'}
//           %span.help We will never sell your email address.
//       .field
//         %label Gender:
//         .controls
//           .control
//             %input{type: 'radio'}
//             %label Male
//           .control
//             %input{type: 'radio'}
//             %label Female
//       .field
//         %label Full name:
//         .controls.horizontal
//           .control
//             %input{type: 'text'}
//             %label First name
//           .control
//             %input{type: 'text'}
//             %label Last name
//
//     # CSS
//     form.my-form {
//       @include if-form-layout;
//
//       #{$if-textboxes} {
//         @include if-textbox; } }
//
// Gives fields in a side-by-side layout. Does not give any visual style to any
// of the elements, it simply gives them layout. This is often used on `fieldset`
// or `form`. You may specify some selectors:
//
//   $field-selector ::
//   The field. Defaults to `.field`. (Tip: set to `>*` to be all-inclusive.)
//
//   $control-group-selector ::
//   Selector for a group of controls to group many controls in a field, say,
//   radio buttons. Defaults to `.controls`.
//
//   $control-selector ::
//   Selector for a control+label pair's parent for multi-textbox fields (See
//   "Full name" in the example). Defaults to `.control`.
//
// You can add `.horizontal` (see "Full name" in the example) to the field
// control group to lay out its controls horizontally.
//
@mixin if-form-layout(
  $label-width: 150px,
  $field-height: 32px,
  $field-margin: 20px,
  $field: $if-form-field,
  $control-group: $if-form-control-group,
  $control: $if-form-control,
) {
  #{$field} {
    @include if-clearfix;
    margin: $field-margin 0;
    min-height: $field-height;
    padding: 0 0 0 $label-width;

    // For checkboxes et al
    input[type=checkbox], input[type=radio] {
      margin-right: 0.75em; }

    > {
      label {
        line-height: $field-height;
        text-align: right;
        width: $label-width;
        margin-left: -1 * $label-width;
        float: left;

        @include box-sizing(border-box);
        padding-right: 1.25em; }

      // For control groups (.controls)
      #{$control-group} {
        display: block;

        span.help {
          display: block; } }

      #{$control-group} { > { #{$control} {
        line-height: $field-height; } } }

      // For label+input pairs, horizontal style
      #{$control-group} { &.horizontal > { #{$control} {
        float: left;
        margin-right: $field-margin;

        label {
          display: block; }
        } } }

      // For textboxes
      #{$control-group}, #{$if-inputs} {
        width: auto;
        @include box-sizing(border-box); } }
  }
}
